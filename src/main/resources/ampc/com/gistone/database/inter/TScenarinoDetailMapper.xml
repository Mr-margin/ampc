<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="ampc.com.gistone.database.inter.TScenarinoDetailMapper" >
  <!-- 返回情景查询列表的数据 -->
  <resultMap id="scenarinoListMap" type="hashMap" >
    <id column="SCENARINO_ID" property="scenarinoId" jdbcType="DECIMAL" />
    <result column="SCENARINO_NAME" property="scenarinoName" jdbcType="OTHER" />
    <result column="SCENARINO_START_DATE" property="scenarinoStartDate" jdbcType="TIMESTAMP" />
    <result column="SCENARINO_END_DATE" property="scenarinoEndDate" jdbcType="TIMESTAMP" />
    <result column="SCENARINO_STATUS" property="scenarinoStatus" jdbcType="DECIMAL" />
    <result column="SCENARINO_STATU_NAME" property="scenarinoStatuName" jdbcType="OTHER" />
    <result column="SCENARINO_ADD_TIME" property="scenarinoAddTime" jdbcType="TIMESTAMP" />
  </resultMap>
  <resultMap id="BaseResultMap" type="ampc.com.gistone.database.model.TScenarinoDetail" >
    <id column="SCENARINO_ID" property="scenarinoId" jdbcType="DECIMAL" />
    <result column="SCENARINO_TYPE" property="scenarinoType" jdbcType="DECIMAL" />
    <result column="SCENARINO_NAME" property="scenarinoName" jdbcType="OTHER" />
    <result column="SCENARINO_START_DATE" property="scenarinoStartDate" jdbcType="TIMESTAMP" />
    <result column="SCENARINO_END_DATE" property="scenarinoEndDate" jdbcType="TIMESTAMP" />
    <result column="SCENARINO_STATUS" property="scenarinoStatus" jdbcType="DECIMAL" />
    <result column="MISSION_ID" property="missionId" jdbcType="DECIMAL" />
    <result column="SCENARINO_ADD_TIME" property="scenarinoAddTime" jdbcType="TIMESTAMP" />
    <result column="USER_ID" property="userId" jdbcType="DECIMAL" />
    <result column="UPDATE_TIME" property="updateTime" jdbcType="TIMESTAMP" />
    <result column="IS_EFFECTIVE" property="isEffective" jdbcType="VARCHAR" />
    <result column="DELETE_TIME" property="deleteTime" jdbcType="TIMESTAMP" />
    <result column="BASIS_SCENARINO_ID" property="basisScenarinoId" jdbcType="DECIMAL" />
    <result column="BASIS_TIME" property="basisTime" jdbcType="TIMESTAMP" />
    <result column="CONTRAST_SCENARINO_ID" property="contrastScenarinoId" jdbcType="DECIMAL" />
    <result column="SCEN_TYPE" property="scenType" jdbcType="VARCHAR" />
    <result column="PATH_DATE" property="pathDate" jdbcType="TIMESTAMP" />
    <result column="SPINUP" property="spinup" jdbcType="DECIMAL" />
    <result column="RATIO_START_DATE" property="ratioStartDate" jdbcType="TIMESTAMP" />
    <result column="RATIO_END_DATE" property="ratioEndDate" jdbcType="TIMESTAMP" />
    <result column="RANGE_DAY" property="rangeDay" jdbcType="DECIMAL" />
    <result column="EXPAND1" property="expand1" jdbcType="VARCHAR" />
    <result column="EXPAND2" property="expand2" jdbcType="VARCHAR" />
    <result column="EXPAND3" property="expand3" jdbcType="VARCHAR" />
    <result column="EXPAND4" property="expand4" jdbcType="VARCHAR" />
    <result column="EXPAND5" property="expand5" jdbcType="VARCHAR" />
    <result column="EXPAND6" property="expand6" jdbcType="VARCHAR" />
    <result column="EXPAND7" property="expand7" jdbcType="VARCHAR" />
    <result column="EXPAND8" property="expand8" jdbcType="VARCHAR" />
    <result column="EXPAND9" property="expand9" jdbcType="VARCHAR" />
    <result column="EXPAND10" property="expand10" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    SCENARINO_ID, SCENARINO_TYPE, SCENARINO_NAME, SCENARINO_START_DATE, SCENARINO_END_DATE, 
    SCENARINO_STATUS, MISSION_ID, SCENARINO_ADD_TIME, USER_ID, UPDATE_TIME, IS_EFFECTIVE, 
    DELETE_TIME, BASIS_SCENARINO_ID, BASIS_TIME, CONTRAST_SCENARINO_ID, SCEN_TYPE, PATH_DATE, 
    SPINUP, RATIO_START_DATE, RATIO_END_DATE, RANGE_DAY, EXPAND1, EXPAND2, EXPAND3, EXPAND4, EXPAND5,
    EXPAND6, EXPAND7, EXPAND8, EXPAND9, EXPAND10
  </sql>
  <!--查询情景的开始时间和结束时间  -->
  <select id="selectStartAndEndDate" parameterType="java.lang.Long" resultMap="BaseResultMap">
  select 
  <include refid="Base_Column_List" />
  from T_SCENARINO_DETAIL where SCENARINO_ID = #{scenarinoId,jdbcType=DECIMAL}
  </select>
  <!--修改情景状态  -->
  <update id="updateScenType" parameterType="hashMap" >
  update T_SCENARINO_DETAIL
  set SCENARINO_STATUS = #{scenarinoStatus,jdbcType=DECIMAL}
  where SCENARINO_ID = #{scenarinoId,jdbcType=DECIMAL}
  </update>
  <!--通过刚创建的实时预报的情景得到该情景的ID  -->
  <select id="selectforecastid" parameterType="ampc.com.gistone.database.model.TScenarinoDetail" resultType="java.lang.Long">
  select SCENARINO_ID from T_SCENARINO_DETAIL where PATH_DATE = #{pathDate,jdbcType=TIMESTAMP} and SCEN_TYPE = '4'
  </select>
  <!-- 通过实时预报的情景pathdate查询ID -->
  <select id="selectBasisId" parameterType="java.util.Date" resultType="java.lang.Long">
  select SCENARINO_ID from T_SCENARINO_DETAIL where PATH_DATE = #{pathDate,jdbcType=TIMESTAMP} and SCEN_TYPE = '4'
  </select>
  
  <!--查询所有的执行状态中的预评估情景  6表示模式执行中 1表示预评估情景 EXPAND1=0表示减排计算完毕-->
  <select id="selectpreEvaluationSituation" resultMap="BaseResultMap">
  select
 <include refid="Base_Column_List" />
  from T_SCENARINO_DETAIL A LEFT JOIN T_TASKS_STATUS B ON A.SCENARINO_ID=B.TASKS_SCENARINO_ID
  where SCENARINO_STATUS ='6' and SCEN_TYPE ='1' and B.TASKS_EXPAND1 ='0'
  </select>
  <!--通过pathdate查询实时预报情景  -->
  <select id="getidByuserIdAndpathdate" resultMap="BaseResultMap" parameterType="hashMap">
  select 
  <include refid="Base_Column_List" />
  from T_SCENARINO_DETAIL where PATH_DATE = #{pathDate,jdbcType=TIMESTAMP} and SCEN_TYPE = '4' and USER_ID = #{userId,jdbcType=DECIMAL}
  </select>
  <!-- 查询补发实时预报情景的全部内容 根据用户-->
  <select id="getForecastScenID" resultMap="BaseResultMap" parameterType="hashMap">
  select 
   <include refid="Base_Column_List" />
   from T_SCENARINO_DETAIL
   where PATH_DATE = #{pathDate,jdbcType=TIMESTAMP} and USER_ID = #{userId,jdbcType=DECIMAL} and SCEN_TYPE = '4'
  </select>
  <!-- 根据ID查找开始时间结束时间和情景类型 -->
  <select id="selecttypetime" resultMap="BaseResultMap" parameterType="java.lang.Long">
  select SCENARINO_START_DATE, SCENARINO_END_DATE,SCEN_TYPE,RANGE_DAY,PATH_DATE
  from T_SCENARINO_DETAIL where SCENARINO_ID = #{scenarinoId,jdbcType=DECIMAL}
  
  </select>
  <!-- 查找情景类型 -->
  <select id="selectscentype" resultType="java.lang.String" parameterType="java.lang.Long">
  select SCEN_TYPE
  from T_SCENARINO_DETAIL where SCENARINO_ID = #{scenarinoId,jdbcType=DECIMAL}
  
  </select>
 <!--获取最新的未运行实时预报  -->
  <select id="getlastrunstatus" resultType="java.util.Date" parameterType="java.lang.Long">
  SELECT MIN(PATH_DATE) 
  FROM T_SCENARINO_DETAIL A LEFT JOIN T_TASKS_STATUS B ON A.SCENARINO_ID=B.TASKS_SCENARINO_ID
  WHERE A.SCENARINO_TYPE='4' AND B.BEIZHU='0' AND A.USER_ID=#{userId,jdbcType=DECIMAL} AND B.BEIZHU2='0'
  </select>
  <!-- 更新cores -->
  <update id="updateCores" parameterType="ampc.com.gistone.database.model.TScenarinoDetail">
  update T_SCENARINO_DETAIL
  set EXPAND3 = #{expand3,jdbcType=VARCHAR}
  where SCENARINO_ID = #{scenarinoId,jdbcType=DECIMAL}
  </update>
  
  <!-- 根据起报时间 用户id 情景类型  查找该条情景记录 用来确定实时预报消息里面的firsttime的值  -->
  <select id="selectFirstTime" resultMap="BaseResultMap" parameterType="hashMap">
  select 
  <include refid="Base_Column_List" />
    from T_SCENARINO_DETAIL
  	where USER_ID=#{userId,jdbcType=DECIMAL} and PATH_DATE=#{pathDate,jdbcType=TIMESTAMP} and SCEN_TYPE=#{scenType,jdbcType=VARCHAR}
  
  </select>
<!--根据用户的ID和情景类型查询该情景的所有的情景  -->
<select id="selectListFirstTime" parameterType="hashMap" resultMap="BaseResultMap">
 select 
  <include refid="Base_Column_List" />
    from T_SCENARINO_DETAIL
  	where USER_ID=#{userId,jdbcType=DECIMAL} and SCEN_TYPE=#{scenType,jdbcType=VARCHAR} ORDER BY PATH_DATE ASC
</select>
  <!-- 返回情景查询列表的列 -->
  <sql id="scenarino_Column_List" >
  	SCENARINO_ID,SCENARINO_NAME,SCENARINO_START_DATE,SCENARINO_END_DATE,SCENARINO_STATUS,
   SCENARINO_STATU_NAME,SCENARINO_ADD_TIME,BASIS_SCENARINO_ID,BASIS_TIME,CONTRAST_SCENARINO_ID,SCEN_TYPE,
   PATH_DATE,SPINUP,EXPAND4
  </sql>
  
  <!-- 返回情景复制列表的数据 -->
  <resultMap id="copyScenarinoListMap" type="hashMap" >
    <result column="MISSION_NAME" property="missionName" jdbcType="OTHER" />
    <result column="ES_COUPLING_NAME" property="esCouplingName" jdbcType="OTHER" />
    <result column="MISSION_STATUS" property="missionStatus" jdbcType="OTHER" />
    <result column="SCENARINO_ID" property="scenarinoId" jdbcType="DECIMAL" />
    <result column="SCENARINO_NAME" property="scenarinoName" jdbcType="OTHER" />
    <result column="SCENARINO_START_DATE" property="scenarinoStartDate" jdbcType="DATE" />
    <result column="SCENARINO_END_DATE" property="scenarinoEndDate" jdbcType="TIMESTAMP" />
    <result column="SCENARINO_STATU_NAME" property="scenarinoStatuName" jdbcType="OTHER" />
    <result column="SCENARINO_ADD_TIME" property="scenarinoAddTime" jdbcType="TIMESTAMP" />
  </resultMap>
  
  <!-- 返回情景复制列表的列 -->
  <sql id="copyScenarino_Column_List" >
  	  MISSION_NAME,ES_COUPLING_NAME,MISSION_STATUS,
	  SCENARINO_ID,SCENARINO_NAME,SCENARINO_START_DATE,SCENARINO_END_DATE,
      SCENARINO_STATU_NAME,SCENARINO_ADD_TIME,BASIS_SCENARINO_ID,BASIS_TIME,CONTRAST_SCENARINO_ID,SCEN_TYPE,
   PATH_DATE,SPINUP
  </sql>
  
  <!-- 查询所有任务列表和情景列表 可根据情景名模糊查询 -->
  <select id="selectAllOrByQueryName" parameterType="hashMap" resultMap="copyScenarinoListMap" >
   SELECT * FROM (
   	 SELECT T.*,ROWNUM AS RN FROM (
         SELECT  <include refid="copyScenarino_Column_List"/>
             FROM T_MISSION_DETAIL  MISS 
							INNER JOIN T_ES_COUPLING  COUP ON MISS.ES_COUPLING_ID= COUP.ES_COUPLING_ID
							INNER JOIN T_DOMAIN_MISSION DOMA ON MISS.MISSION_DOMAIN_ID=DOMA.DOMAIN_ID
						  INNER JOIN T_SCENARINO_DETAIL SCEN ON MISS.MISSION_ID=SCEN.MISSION_ID
						  INNER JOIN T_SCENARINO_STATUS STAT  ON SCEN.SCENARINO_STATUS=STAT.SCENARINO_STATU_ID
									WHERE MISS.IS_EFFECTIVE='1' AND MISS.USER_ID=#{userId,jdbcType=OTHER}  AND
											  SCEN.IS_EFFECTIVE='1' AND SCEN.USER_ID=#{userId,jdbcType=OTHER} 
											    <if test="missionStatus != null" >
        											AND MISSION_STATUS= #{missionStatus,jdbcType=OTHER}
      		 									</if>
										         <if test="queryName != null" >
										       		AND (MISSION_NAME LIKE #{queryName,jdbcType=OTHER}
										    
										       		OR ES_COUPLING_NAME LIKE #{queryName,jdbcType=OTHER}
										       		OR MISSION_STATUS LIKE #{queryName,jdbcType=OTHER}
										       		OR SCENARINO_NAME LIKE #{queryName,jdbcType=OTHER}
										       		OR SCENARINO_STATU_NAME LIKE #{queryName,jdbcType=OTHER})
										      	</if>
											ORDER BY MISS.MISSION_ID DESC
	                                     ) T WHERE ROWNUM &lt;=#{endNum,jdbcType=OTHER}
	                               ) 
 	                               WHERE RN > #{startNum,jdbcType=OTHER}
   	
  </select>
  <!-- 查询所有任务列表和情景列表 可根据情景名模糊查询 -->
  <select id="selectAllOrByQueryName2" parameterType="hashMap" resultMap="copyScenarinoListMap" >
   SELECT * FROM (
   	 SELECT T.*,ROWNUM AS RN FROM (
         SELECT  <include refid="copyScenarino_Column_List"/>
             FROM T_MISSION_DETAIL  MISS 
							INNER JOIN T_ES_COUPLING  COUP ON MISS.ES_COUPLING_ID= COUP.ES_COUPLING_ID
							INNER JOIN T_DOMAIN_MISSION DOMA ON MISS.MISSION_DOMAIN_ID=DOMA.DOMAIN_ID
						  INNER JOIN T_SCENARINO_DETAIL SCEN ON MISS.MISSION_ID=SCEN.MISSION_ID
						  INNER JOIN T_SCENARINO_STATUS STAT  ON SCEN.SCENARINO_STATUS=STAT.SCENARINO_STATU_ID
									WHERE MISS.IS_EFFECTIVE='1' AND MISS.USER_ID=#{userId,jdbcType=OTHER}  AND
											  SCEN.IS_EFFECTIVE='1' AND SCEN.USER_ID=#{userId,jdbcType=OTHER} AND SCEN.SCENARINO_STATUS!=1
											    <if test="missionStatus != null" >
        											AND MISSION_STATUS= #{missionStatus,jdbcType=OTHER}
      		 									</if>
										         <if test="queryName != null" >
										       		AND (MISSION_NAME LIKE #{queryName,jdbcType=OTHER}
										       		
										       		OR ES_COUPLING_NAME LIKE #{queryName,jdbcType=OTHER}
										       		OR MISSION_STATUS LIKE #{queryName,jdbcType=OTHER}
										       		OR SCENARINO_NAME LIKE #{queryName,jdbcType=OTHER}
										       		OR SCENARINO_STATU_NAME LIKE #{queryName,jdbcType=OTHER})
										      	</if>
											ORDER BY MISS.MISSION_ID DESC
	                                     ) T
	                               ) 
 	                               WHERE ROWNUM &lt;=#{endNum,jdbcType=OTHER}
 	                               AND RN > #{startNum,jdbcType=OTHER} AND SCEN_TYPE!='4' AND SCEN_TYPE!='3'
   	
  </select>
  
  
  
   <select id="selectAllcountOrByQueryName2" parameterType="hashMap" resultType="int">
   SELECT COUNT(*) FROM (
   	 SELECT T.*,ROWNUM AS RN FROM (
         SELECT  <include refid="copyScenarino_Column_List"/>
             FROM T_MISSION_DETAIL  MISS 
							INNER JOIN T_ES_COUPLING  COUP ON MISS.ES_COUPLING_ID= COUP.ES_COUPLING_ID
							INNER JOIN T_DOMAIN_MISSION DOMA ON MISS.MISSION_DOMAIN_ID=DOMA.DOMAIN_ID
						  INNER JOIN T_SCENARINO_DETAIL SCEN ON MISS.MISSION_ID=SCEN.MISSION_ID
						  INNER JOIN T_SCENARINO_STATUS STAT  ON SCEN.SCENARINO_STATUS=STAT.SCENARINO_STATU_ID
									WHERE MISS.IS_EFFECTIVE='1' AND MISS.USER_ID=#{userId,jdbcType=OTHER}  AND
											  SCEN.IS_EFFECTIVE='1' AND SCEN.USER_ID=#{userId,jdbcType=OTHER} AND SCEN.SCENARINO_STATUS!=1
											    <if test="missionStatus != null" >
        											AND MISSION_STATUS= #{missionStatus,jdbcType=OTHER}
      		 									</if>
										         <if test="queryName != null" >
										       		AND (MISSION_NAME LIKE #{queryName,jdbcType=OTHER}
										       		
										       		OR ES_COUPLING_NAME LIKE #{queryName,jdbcType=OTHER}
										       		OR MISSION_STATUS LIKE #{queryName,jdbcType=OTHER}
										       		OR SCENARINO_NAME LIKE #{queryName,jdbcType=OTHER}
										       		OR SCENARINO_STATU_NAME LIKE #{queryName,jdbcType=OTHER})
										      	</if>
											ORDER BY MISS.MISSION_ID DESC
	                                     ) T
	                               ) 
 	                               WHERE SCEN_TYPE!='4' AND SCEN_TYPE!='3'
   	
  </select>
  
  
  <!--不分页查询所有有效的条数 可根据条件名模糊查询-->
  <select id="selectCountOrByQueryName" parameterType="hashMap" resultType="int">
  	 SELECT COUNT(*) FROM T_MISSION_DETAIL  MISS 
  	  				INNER JOIN T_ES_COUPLING  COUP ON MISS.ES_COUPLING_ID= COUP.ES_COUPLING_ID
					INNER JOIN T_DOMAIN_MISSION DOMA ON MISS.MISSION_DOMAIN_ID=DOMA.DOMAIN_ID
					INNER JOIN T_SCENARINO_DETAIL SCEN ON MISS.MISSION_ID=SCEN.MISSION_ID
					INNER JOIN T_SCENARINO_STATUS STAT  ON SCEN.SCENARINO_STATUS=STAT.SCENARINO_STATU_ID
  		 WHERE MISS.IS_EFFECTIVE='1' AND MISS.USER_ID=#{userId,jdbcType=OTHER}  AND
			SCEN.IS_EFFECTIVE='1' AND SCEN.USER_ID=#{userId,jdbcType=OTHER} 
  	    <if test="missionStatus != null" >
        	AND MISSION_STATUS= #{missionStatus,jdbcType=OTHER}
      	</if>
  	    <if test="queryName != null" >
       		AND (MISSION_NAME LIKE #{queryName,jdbcType=OTHER}
       	
       		OR ES_COUPLING_NAME LIKE #{queryName,jdbcType=OTHER}
       		OR MISSION_STATUS LIKE #{queryName,jdbcType=OTHER}
       		OR SCENARINO_NAME LIKE #{queryName,jdbcType=OTHER}
       		OR SCENARINO_STATU_NAME LIKE #{queryName,jdbcType=OTHER})
      	</if>
  </select>
  
  
   <select id="selectCountOrByQueryName2" parameterType="hashMap" resultType="int">
  	 SELECT COUNT(*) FROM T_MISSION_DETAIL  MISS 
  	  				INNER JOIN T_ES_COUPLING  COUP ON MISS.ES_COUPLING_ID= COUP.ES_COUPLING_ID
					INNER JOIN T_DOMAIN_MISSION DOMA ON MISS.MISSION_DOMAIN_ID=DOMA.DOMAIN_ID
					INNER JOIN T_SCENARINO_DETAIL SCEN ON MISS.MISSION_ID=SCEN.MISSION_ID
					INNER JOIN T_SCENARINO_STATUS STAT  ON SCEN.SCENARINO_STATUS=STAT.SCENARINO_STATU_ID
  		 WHERE MISS.IS_EFFECTIVE='1' AND MISS.USER_ID=#{userId,jdbcType=OTHER}  AND
			SCEN.IS_EFFECTIVE='1' AND SCEN.USER_ID=#{userId,jdbcType=OTHER} AND SCEN_TYPE!='4' AND SCEN_TYPE!='3'
  	    <if test="missionStatus != null" >
        	AND MISSION_STATUS= #{missionStatus,jdbcType=OTHER}
      	</if>
  	    <if test="queryName != null" >
       		AND (MISSION_NAME LIKE #{queryName,jdbcType=OTHER}
       	
       		OR ES_COUPLING_NAME LIKE #{queryName,jdbcType=OTHER}
       		OR MISSION_STATUS LIKE #{queryName,jdbcType=OTHER}
       		OR SCENARINO_NAME LIKE #{queryName,jdbcType=OTHER}
       		OR SCENARINO_STATU_NAME LIKE #{queryName,jdbcType=OTHER})
      	</if>
  </select>
  
   <!-- 根据任务Id查询情景列表 并可根据条件名模糊查询 -->
  <select id="selectByMissionIdAndQueryName" parameterType="hashMap" resultMap="scenarinoListMap" >
   	 SELECT  <include refid="scenarino_Column_List"/>
  		FROM T_SCENARINO_DETAIL  SCEN 
  		INNER JOIN T_SCENARINO_STATUS STAT  ON SCEN.SCENARINO_STATUS=STAT.SCENARINO_STATU_ID
			  WHERE IS_EFFECTIVE='1' AND USER_ID=#{userId,jdbcType=OTHER} 
			  AND MISSION_ID=#{missionId,jdbcType=OTHER} AND SCEN_TYPE!='4'
			  <if test="queryName != null" >
        		AND (SCENARINO_NAME LIKE #{queryName,jdbcType=OTHER}
        		OR to_char(SCENARINO_START_DATE,'yyyy-mm-dd HH') LIKE #{queryName,jdbcType=OTHER}
        		OR to_char(SCENARINO_END_DATE,'yyyy-mm-dd HH') LIKE #{queryName,jdbcType=OTHER}
        		OR to_char(SCENARINO_ADD_TIME,'yyyy-mm-dd HH') LIKE #{queryName,jdbcType=OTHER}
        		OR SCENARINO_STATU_NAME LIKE #{queryName,jdbcType=OTHER})
      		 </if>
			  ORDER BY SCENARINO_ID DESC
  </select>
  
  <!-- 根据任务Id查询出所有的情景Id 用来级联删除 -->
  <select id="selectByMissionId" parameterType="hashMap" resultType="java.lang.Long" >
     SELECT SCENARINO_ID FROM T_SCENARINO_DETAIL 
		WHERE MISSION_ID=#{missionId,jdbcType=OTHER} AND IS_EFFECTIVE='1' AND USER_ID=#{userId,jdbcType=OTHER} 
  </select>
  
  <!-- 根据任务ID和情景名称 查询情景ID -->
  <select id="selectByMidAndSName" parameterType="hashMap" resultType="java.lang.Long" >
   	 SELECT  SCENARINO_ID
  		FROM T_SCENARINO_DETAIL  
			 WHERE MISSION_ID=#{missionId,jdbcType=OTHER} AND IS_EFFECTIVE='1'
			 	AND SCENARINO_NAME=#{scenarinoName,jdbcType=OTHER}
  </select>
  <!--通过情景ID查询任务ID  -->
  <select id="selectMissionidByID" parameterType="java.lang.Long" resultType="java.lang.Long">
  select MISSION_ID from T_SCENARINO_DETAIL where SCENARINO_ID = #{scenarinoId,jdbcType=DECIMAL}
  </select>
   
   <!-- 根据起报日期查询当条记录的实时预报的fnl是否跑完  -->
 <!--  <select id="selectTasksstatusByPathdate" parameterType="hashMap" resultType="ampc.com.gistone.database.model.TTasksStatus">
  select
   TASKS_ID, TASKS_SCENARINO_ID, ERROR_STATUS, A.SCENARINO_START_DATE,A.SCENARINO_END_DATE, A.RANGE_DAY, STEPINDEX, TASKS_END_DATE, SOURCEID, CALCTYPE, PSAL, SSAL, MEICCITYCONFIG,
      BEIZHU, BEIZHU2, BEIZHU3
  from T_TASKS_STATUS A LEFT JOIN T_SCENARINO_DETAIL B ON A.TASKS_SCENARINO_ID=B.SCENARINO_ID
   WHERE B.PATH_DATE = #{pathDate,jdbcType=TIMESTAMP} AND B.SCEN_TYPE=#{scenType,jdbcType=VARCHAR} AND B.USER_ID = #{userId,jdbcType=DECIMAL}
  </select> -->
  <!--查询所有的情景 根据类型和起报时间  -->
  <select id="selectAllByPathdateAndtype" parameterType="hashMap" resultMap="BaseResultMap">
  SELECT 
		<include refid="Base_Column_List" />
  		FROM T_SCENARINO_DETAIL  
  		WHERE PATH_DATE = #{pathDate,jdbcType=TIMESTAMP} AND SCEN_TYPE=#{scenType,jdbcType=VARCHAR}
  </select>
  <!-- 查找正在执行的实时预报 -->
  <select id="selectAllOnExecByPathdateAndtype" parameterType="hashMap" resultMap="BaseResultMap">
   SELECT 
		<include refid="Base_Column_List" />
  		FROM T_SCENARINO_DETAIL  
  		WHERE PATH_DATE = #{pathDate,jdbcType=TIMESTAMP} AND SCEN_TYPE=#{scenType,jdbcType=VARCHAR} AND SCENARINO_STATUS = '6'
  </select>
   <!--添加情景对名称重复判断-->
  <select id="check_ScenarinoName" parameterType="hashMap" resultType="int">
  	 SELECT COUNT(*) FROM T_SCENARINO_DETAIL WHERE IS_EFFECTIVE='1' AND USER_ID=#{userId,jdbcType=OTHER} 
  	     AND MISSION_ID=#{missionId,jdbcType=OTHER}
  	  <if test="scenarinoName != null" >
        	AND SCENARINO_NAME = #{scenarinoName,jdbcType=OTHER}
      </if>
  </select>
  
  <!-- 修改所有的情景状态 相当于删除 -->
  <update id="updateIsEffeByIds" parameterType="java.util.List">
    update T_SCENARINO_DETAIL
    set 
      IS_EFFECTIVE = '0',
      DELETE_TIME = (select sysdate from dual) 
     where SCENARINO_ID in 
        <foreach collection="list" index="index" item="item" separator="," open="(" close=")">
     		 #{item,jdbcType=DECIMAL}
  		</foreach>
  </update>
  
  <select id="selectAllByMissionId" resultMap="BaseResultMap" parameterType="java.lang.Long" >
   	 SELECT 
		<include refid="Base_Column_List" />
  		FROM T_SCENARINO_DETAIL  
			 WHERE MISSION_ID=#{missionId,jdbcType=DECIMAL} AND IS_EFFECTIVE='1'
		ORDER BY SCENARINO_END_DATE DESC
  </select>
  <select id="selectMaxEndTime" resultMap="BaseResultMap" parameterType="java.lang.Long">
  SELECT
	*
FROM
	T_SCENARINO_DETAIL S
WHERE
	S.SCENARINO_END_DATE = (SELECT MAX (SCENARINO_END_DATE)
FROM
	T_SCENARINO_DETAIL
WHERE
	SCEN_TYPE = '3'
AND IS_EFFECTIVE = '1' AND MISSION_ID=#{missionId,jdbcType=DECIMAL})
AND S.IS_EFFECTIVE = '1' AND S.MISSION_ID=#{missionId,jdbcType=DECIMAL} AND SCEN_TYPE = '3'
  </select>
  
  <select id="selectMaxEndTime4" resultMap="BaseResultMap" >
  SELECT
	*
FROM
	T_SCENARINO_DETAIL S
WHERE
	S.PATH_DATE = (SELECT MAX (PATH_DATE)
FROM
	T_SCENARINO_DETAIL
WHERE
	SCEN_TYPE = '4'
AND IS_EFFECTIVE = '1')
AND IS_EFFECTIVE = '1'
  </select>
  <select id="selectid" resultMap="BaseResultMap" parameterType="ampc.com.gistone.database.model.TScenarinoDetail" >
   	 SELECT 
		<include refid="Base_Column_List" />
  		FROM T_SCENARINO_DETAIL  
			 WHERE 1=1
			 <if test="scenarinoType != null" >
       and SCENARINO_TYPE = #{scenarinoType,jdbcType=DECIMAL}
      </if>
      <if test="scenarinoName != null" >
       and SCENARINO_NAME = #{scenarinoName,jdbcType=OTHER}
      </if>
      <if test="scenarinoStartDate != null" >
       and SCENARINO_START_DATE = #{scenarinoStartDate,jdbcType=TIMESTAMP}
      </if>
      <if test="scenarinoEndDate != null" >
       and SCENARINO_END_DATE = #{scenarinoEndDate,jdbcType=TIMESTAMP}
      </if>
      <if test="scenarinoStatus != null" >
       and SCENARINO_STATUS = #{scenarinoStatus,jdbcType=DECIMAL}
      </if>
      <if test="missionId != null" >
       and MISSION_ID = #{missionId,jdbcType=DECIMAL}
      </if>
      <if test="scenarinoAddTime != null" >
       and SCENARINO_ADD_TIME = #{scenarinoAddTime,jdbcType=TIMESTAMP}
      </if>
      <if test="userId != null" >
       and USER_ID = #{userId,jdbcType=DECIMAL}
      </if>
      <if test="updateTime != null" >
       and UPDATE_TIME = #{updateTime,jdbcType=TIMESTAMP}
      </if>
      <if test="isEffective != null" >
       and IS_EFFECTIVE = #{isEffective,jdbcType=VARCHAR}
      </if>
      <if test="deleteTime != null" >
       and DELETE_TIME = #{deleteTime,jdbcType=TIMESTAMP}
      </if>
       <if test="basisScenarinoId != null" >
       and BASIS_SCENARINO_ID = #{basisScenarinoId,jdbcType=DECIMAL}
      </if>
       <if test="basisTime != null" >
       and BASIS_TIME = #{basisTime,jdbcType=TIMESTAMP}
      </if>
       <if test="contrastScenarinoId != null and contrastScenarinoId!=''" >
       and CONTRAST_SCENARINO_ID = #{contrastScenarinoId,jdbcType=DECIMAL}
      </if>
       <if test="scenType != null and scenType !=''" >
       and SCEN_TYPE = #{scenType,jdbcType=VARCHAR}
      </if>
       <if test="pathDate != null" >
       and PATH_DATE = #{pathDate,jdbcType=TIMESTAMP}
      </if>
      <if test="spinup != null" >
       and SPINUP = #{spinup,jdbcType=DECIMAL}
      </if>
        <if test="expand1 != null" >
       and EXPAND1 = #{expand1,jdbcType=VARCHAR}
      </if>
        <if test="expand2 != null" >
       and EXPAND2 = #{expand2,jdbcType=VARCHAR}
      </if> 
        <if test="expand3 != null" >
       and EXPAND3 = #{expand3,jdbcType=VARCHAR}
      </if>
        <if test="expand4 != null" >
       and EXPAND4 = #{expand4,jdbcType=VARCHAR}
      </if>   
        <if test="expand5 != null" >
       and EXPAND5 = #{expand5,jdbcType=VARCHAR}
      </if>
        <if test="expand6 != null" >
       and EXPAND6 = #{expand6,jdbcType=VARCHAR}
      </if>
        <if test="expand7 != null" >
       and EXPAND7 = #{expand7,jdbcType=VARCHAR}
      </if>   
        <if test="expand8 != null" >
       and EXPAND8 = #{expand8,jdbcType=VARCHAR}
      </if>      
        <if test="expand9 != null" >
       and EXPAND9 = #{expand9,jdbcType=VARCHAR}
      </if>
        <if test="expand10 != null" >
       and EXPAND10 = #{expand10,jdbcType=VARCHAR}
      </if>
  </select>
  
  
  
  
  
  
  
  
  
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Long" >
    select 
    <include refid="Base_Column_List" />
    from T_SCENARINO_DETAIL
    where SCENARINO_ID = #{scenarinoId,jdbcType=DECIMAL}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long" >
    delete from T_SCENARINO_DETAIL
    where SCENARINO_ID = #{scenarinoId,jdbcType=DECIMAL}
  </delete>
  <insert id="insert" parameterType="ampc.com.gistone.database.model.TScenarinoDetail" >
    insert into T_SCENARINO_DETAIL (SCENARINO_ID, SCENARINO_TYPE, SCENARINO_NAME, 
      SCENARINO_START_DATE, SCENARINO_END_DATE, 
      SCENARINO_STATUS, MISSION_ID, SCENARINO_ADD_TIME, 
      USER_ID, UPDATE_TIME, IS_EFFECTIVE, 
      DELETE_TIME, BASIS_SCENARINO_ID, BASIS_TIME, 
      CONTRAST_SCENARINO_ID, SCEN_TYPE, PATH_DATE, 
      SPINUP, RATIO_START_DATE, RATIO_END_DATE, 
      RANGE_DAY, EXPAND1, EXPAND2, EXPAND3, EXPAND4, EXPAND5,
    EXPAND6, EXPAND7, EXPAND8, EXPAND9, EXPAND10)
    values (#{scenarinoId,jdbcType=DECIMAL}, #{scenarinoType,jdbcType=DECIMAL}, #{scenarinoName,jdbcType=OTHER}, 
      #{scenarinoStartDate,jdbcType=TIMESTAMP}, #{scenarinoEndDate,jdbcType=TIMESTAMP}, 
      #{scenarinoStatus,jdbcType=DECIMAL}, #{missionId,jdbcType=DECIMAL}, #{scenarinoAddTime,jdbcType=TIMESTAMP}, 
      #{userId,jdbcType=DECIMAL}, #{updateTime,jdbcType=TIMESTAMP}, #{isEffective,jdbcType=VARCHAR}, 
      #{deleteTime,jdbcType=TIMESTAMP}, #{basisScenarinoId,jdbcType=DECIMAL}, #{basisTime,jdbcType=TIMESTAMP}, 
      #{contrastScenarinoId,jdbcType=DECIMAL}, #{scenType,jdbcType=VARCHAR}, #{pathDate,jdbcType=TIMESTAMP}, 
      #{spinup,jdbcType=DECIMAL}, #{ratioStartDate,jdbcType=TIMESTAMP}, #{ratioEndDate,jdbcType=TIMESTAMP}, 
      #{rangeDay,jdbcType=DECIMAL}, #{expand1,jdbcType=VARCHAR}, #{expand2,jdbcType=VARCHAR}, #{expand3,jdbcType=VARCHAR},
      #{expand4,jdbcType=VARCHAR}, #{expand5,jdbcType=VARCHAR}, #{expand6,jdbcType=VARCHAR}, #{expand7,jdbcType=VARCHAR},
      #{expand8,jdbcType=VARCHAR}, #{expand9,jdbcType=VARCHAR}, #{expand10,jdbcType=VARCHAR})
  </insert>
  
  <insert id="insertSelective" parameterType="ampc.com.gistone.database.model.TScenarinoDetail" >
    insert into T_SCENARINO_DETAIL
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="scenarinoId != null" >
        SCENARINO_ID,
      </if>
      <if test="scenarinoType != null" >
        SCENARINO_TYPE,
      </if>
      <if test="scenarinoName != null" >
        SCENARINO_NAME,
      </if>
      <if test="scenarinoStartDate != null" >
        SCENARINO_START_DATE,
      </if>
      <if test="scenarinoEndDate != null" >
        SCENARINO_END_DATE,
      </if>
      <if test="scenarinoStatus != null" >
        SCENARINO_STATUS,
      </if>
      <if test="missionId != null" >
        MISSION_ID,
      </if>
      <if test="scenarinoAddTime != null" >
        SCENARINO_ADD_TIME,
      </if>
      <if test="userId != null" >
        USER_ID,
      </if>
      <if test="updateTime != null" >
        UPDATE_TIME,
      </if>
      <if test="isEffective != null" >
        IS_EFFECTIVE,
      </if>
      <if test="deleteTime != null" >
        DELETE_TIME,
      </if>
      <if test="basisScenarinoId != null" >
        BASIS_SCENARINO_ID,
      </if>
      <if test="basisTime != null" >
        BASIS_TIME,
      </if>
      <if test="contrastScenarinoId != null" >
        CONTRAST_SCENARINO_ID,
      </if>
      <if test="scenType != null" >
        SCEN_TYPE,
      </if>
      <if test="pathDate != null" >
        PATH_DATE,
      </if>
      <if test="spinup != null" >
        SPINUP,
      </if>
      <if test="ratioStartDate != null" >
        RATIO_START_DATE,
      </if>
      <if test="ratioEndDate != null" >
        RATIO_END_DATE,
      </if>
      <if test="rangeDay != null" >
        RANGE_DAY,
      </if>
      <if test="expand1 != null" >
        EXPAND1,
      </if>
       <if test="expand2 != null" >
        EXPAND2,
      </if>
       <if test="expand3 != null" >
        EXPAND3,
      </if>
       <if test="expand4 != null" >
        EXPAND4,
      </if>
       <if test="expand5 != null" >
        EXPAND5,
      </if>
       <if test="expand6 != null" >
        EXPAND6,
      </if>
       <if test="expand7 != null" >
        EXPAND7,
      </if>
       <if test="expand8 != null" >
        EXPAND8,
      </if>
       <if test="expand9 != null" >
        EXPAND9,
      </if>
       <if test="expand10 != null" >
        EXPAND10,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="scenarinoId != null" >
        #{scenarinoId,jdbcType=DECIMAL},
      </if>
      <if test="scenarinoType != null" >
        #{scenarinoType,jdbcType=DECIMAL},
      </if>
      <if test="scenarinoName != null" >
        #{scenarinoName,jdbcType=OTHER},
      </if>
      <if test="scenarinoStartDate != null" >
        #{scenarinoStartDate,jdbcType=TIMESTAMP},
      </if>
      <if test="scenarinoEndDate != null" >
        #{scenarinoEndDate,jdbcType=TIMESTAMP},
      </if>
      <if test="scenarinoStatus != null" >
        #{scenarinoStatus,jdbcType=DECIMAL},
      </if>
      <if test="missionId != null" >
        #{missionId,jdbcType=DECIMAL},
      </if>
      <if test="scenarinoAddTime != null" >
        #{scenarinoAddTime,jdbcType=TIMESTAMP},
      </if>
      <if test="userId != null" >
        #{userId,jdbcType=DECIMAL},
      </if>
      <if test="updateTime != null" >
        #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="isEffective != null" >
        #{isEffective,jdbcType=VARCHAR},
      </if>
      <if test="deleteTime != null" >
        #{deleteTime,jdbcType=TIMESTAMP},
      </if>
      <if test="basisScenarinoId != null" >
        #{basisScenarinoId,jdbcType=DECIMAL},
      </if>
      <if test="basisTime != null" >
        #{basisTime,jdbcType=TIMESTAMP},
      </if>
      <if test="contrastScenarinoId != null" >
        #{contrastScenarinoId,jdbcType=DECIMAL},
      </if>
      <if test="scenType != null" >
        #{scenType,jdbcType=VARCHAR},
      </if>
      <if test="pathDate != null" >
        #{pathDate,jdbcType=TIMESTAMP},
      </if>
      <if test="spinup != null" >
        #{spinup,jdbcType=DECIMAL},
      </if>
      <if test="ratioStartDate != null" >
        #{ratioStartDate,jdbcType=TIMESTAMP},
      </if>
      <if test="ratioEndDate != null" >
        #{ratioEndDate,jdbcType=TIMESTAMP},
      </if>
      <if test="rangeDay != null" >
        #{rangeDay,jdbcType=DECIMAL},
      </if>
       <if test="expand1 != null" >
        #{expand1,jdbcType=VARCHAR},
      </if>
      <if test="expand2 != null" >
        #{expand2,jdbcType=VARCHAR},
      </if>
      <if test="expand3 != null" >
        #{expand3,jdbcType=VARCHAR},
      </if>
      <if test="expand4 != null" >
        #{expand4,jdbcType=VARCHAR},
      </if>
      <if test="expand5 != null" >
        #{expand5,jdbcType=VARCHAR},
      </if>
      <if test="expand6 != null" >
        #{expand6,jdbcType=VARCHAR},
      </if>
      <if test="expand7 != null" >
        #{expand7,jdbcType=VARCHAR},
      </if>
      <if test="expand8 != null" >
        #{expand8,jdbcType=VARCHAR},
      </if>
      <if test="expand9 != null" >
        #{expand9,jdbcType=VARCHAR},
      </if>
      <if test="expand10 != null" >
        #{expand10,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="ampc.com.gistone.database.model.TScenarinoDetail" >
    update T_SCENARINO_DETAIL
    <set >
      <if test="scenarinoType != null" >
        SCENARINO_TYPE = #{scenarinoType,jdbcType=DECIMAL},
      </if>
      <if test="scenarinoName != null" >
        SCENARINO_NAME = #{scenarinoName,jdbcType=OTHER},
      </if>
      <if test="scenarinoStartDate != null" >
        SCENARINO_START_DATE = #{scenarinoStartDate,jdbcType=TIMESTAMP},
      </if>
      <if test="scenarinoEndDate != null" >
        SCENARINO_END_DATE = #{scenarinoEndDate,jdbcType=TIMESTAMP},
      </if>
      <if test="scenarinoStatus != null" >
        SCENARINO_STATUS = #{scenarinoStatus,jdbcType=DECIMAL},
      </if>
      <if test="missionId != null" >
        MISSION_ID = #{missionId,jdbcType=DECIMAL},
      </if>
      <if test="scenarinoAddTime != null" >
        SCENARINO_ADD_TIME = #{scenarinoAddTime,jdbcType=TIMESTAMP},
      </if>
      <if test="userId != null" >
        USER_ID = #{userId,jdbcType=DECIMAL},
      </if>
      <if test="updateTime != null" >
        UPDATE_TIME = #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="isEffective != null" >
        IS_EFFECTIVE = #{isEffective,jdbcType=VARCHAR},
      </if>
      <if test="deleteTime != null" >
        DELETE_TIME = #{deleteTime,jdbcType=TIMESTAMP},
      </if>
      <if test="basisScenarinoId != null" >
        BASIS_SCENARINO_ID = #{basisScenarinoId,jdbcType=DECIMAL},
      </if>
      <if test="basisTime != null" >
        BASIS_TIME = #{basisTime,jdbcType=TIMESTAMP},
      </if>
      <if test="contrastScenarinoId != null" >
        CONTRAST_SCENARINO_ID = #{contrastScenarinoId,jdbcType=DECIMAL},
      </if>
      <if test="scenType != null" >
        SCEN_TYPE = #{scenType,jdbcType=VARCHAR},
      </if>
      <if test="pathDate != null" >
        PATH_DATE = #{pathDate,jdbcType=TIMESTAMP},
      </if>
      <if test="spinup != null" >
        SPINUP = #{spinup,jdbcType=DECIMAL},
      </if>
      <if test="ratioStartDate != null" >
        RATIO_START_DATE = #{ratioStartDate,jdbcType=TIMESTAMP},
      </if>
      <if test="ratioEndDate != null" >
        RATIO_END_DATE = #{ratioEndDate,jdbcType=TIMESTAMP},
      </if>
      <if test="rangeDay != null" >
        RANGE_DAY = #{rangeDay,jdbcType=DECIMAL},
      </if>
      <if test="expand1 != null" >
       EXPAND1 = #{expand1,jdbcType=VARCHAR},
      </if>
        <if test="expand2 != null" >
       EXPAND2 = #{expand2,jdbcType=VARCHAR},
      </if> 
        <if test="expand3 != null" >
       EXPAND3 = #{expand3,jdbcType=VARCHAR},
      </if>
        <if test="expand4 != null" >
       EXPAND4 = #{expand4,jdbcType=VARCHAR},
      </if>   
        <if test="expand5 != null" >
       EXPAND5 = #{expand5,jdbcType=VARCHAR},
      </if>
        <if test="expand6 != null" >
       EXPAND6 = #{expand6,jdbcType=VARCHAR},
      </if>
        <if test="expand7 != null" >
       EXPAND7 = #{expand7,jdbcType=VARCHAR},
      </if>   
        <if test="expand8 != null" >
       EXPAND8 = #{expand8,jdbcType=VARCHAR},
      </if>      
        <if test="expand9 != null" >
       EXPAND9 = #{expand9,jdbcType=VARCHAR},
      </if>
        <if test="expand10 != null" >
       EXPAND10 = #{expand10,jdbcType=VARCHAR},
      </if>
    </set>
    where SCENARINO_ID = #{scenarinoId,jdbcType=DECIMAL}
  </update>
  <update id="updateByPrimaryKey" parameterType="ampc.com.gistone.database.model.TScenarinoDetail" >
    update T_SCENARINO_DETAIL
    set SCENARINO_TYPE = #{scenarinoType,jdbcType=DECIMAL},
      SCENARINO_NAME = #{scenarinoName,jdbcType=OTHER},
      SCENARINO_START_DATE = #{scenarinoStartDate,jdbcType=TIMESTAMP},
      SCENARINO_END_DATE = #{scenarinoEndDate,jdbcType=TIMESTAMP},
      SCENARINO_STATUS = #{scenarinoStatus,jdbcType=DECIMAL},
      MISSION_ID = #{missionId,jdbcType=DECIMAL},
      SCENARINO_ADD_TIME = #{scenarinoAddTime,jdbcType=TIMESTAMP},
      USER_ID = #{userId,jdbcType=DECIMAL},
      UPDATE_TIME = #{updateTime,jdbcType=TIMESTAMP},
      IS_EFFECTIVE = #{isEffective,jdbcType=VARCHAR},
      DELETE_TIME = #{deleteTime,jdbcType=TIMESTAMP},
      BASIS_SCENARINO_ID = #{basisScenarinoId,jdbcType=DECIMAL},
      BASIS_TIME = #{basisTime,jdbcType=TIMESTAMP},
      CONTRAST_SCENARINO_ID = #{contrastScenarinoId,jdbcType=DECIMAL},
      SCEN_TYPE = #{scenType,jdbcType=VARCHAR},
      PATH_DATE = #{pathDate,jdbcType=TIMESTAMP},
      SPINUP = #{spinup,jdbcType=DECIMAL},
      RATIO_START_DATE = #{ratioStartDate,jdbcType=TIMESTAMP},
      RATIO_END_DATE = #{ratioEndDate,jdbcType=TIMESTAMP},
      RANGE_DAY = #{rangeDay,jdbcType=DECIMAL},
      EXPAND1 = #{expand1,jdbcType=VARCHAR},
      EXPAND2 = #{expand2,jdbcType=VARCHAR},
      EXPAND3 = #{expand3,jdbcType=VARCHAR},
      EXPAND4 = #{expand4,jdbcType=VARCHAR},
      EXPAND5 = #{expand5,jdbcType=VARCHAR},
      EXPAND6 = #{expand6,jdbcType=VARCHAR},
      EXPAND7 = #{expand7,jdbcType=VARCHAR},
      EXPAND8 = #{expand8,jdbcType=VARCHAR},
      EXPAND9 = #{expand9,jdbcType=VARCHAR},
      EXPAND10 = #{expand10,jdbcType=VARCHAR} 
    where SCENARINO_ID = #{scenarinoId,jdbcType=DECIMAL}
  </update>
  
  <select id="selectByEntity" resultMap="BaseResultMap" parameterType="ampc.com.gistone.database.model.TScenarinoDetail" >
   	 SELECT *
  		FROM T_SCENARINO_DETAIL  
			 WHERE IS_EFFECTIVE ='1'
	  <if test="scenarinoType != null" >
       and SCENARINO_TYPE = #{scenarinoType,jdbcType=DECIMAL}
      </if>
      <if test="scenarinoName != null" >
       and SCENARINO_NAME = #{scenarinoName,jdbcType=OTHER}
      </if>
      <if test="scenarinoStartDate != null" >
       and SCENARINO_START_DATE = #{scenarinoStartDate,jdbcType=TIMESTAMP}
      </if>
      <if test="scenarinoEndDate != null" >
       and SCENARINO_END_DATE = #{scenarinoEndDate,jdbcType=TIMESTAMP}
      </if>
      <if test="scenarinoStatus != null" >
       and SCENARINO_STATUS = #{scenarinoStatus,jdbcType=DECIMAL}
      </if>
      <if test="missionId != null" >
       and MISSION_ID = #{missionId,jdbcType=DECIMAL}
      </if>
      <if test="scenarinoAddTime != null" >
       and SCENARINO_ADD_TIME = #{scenarinoAddTime,jdbcType=TIMESTAMP}
      </if>
      <if test="userId != null" >
       and USER_ID = #{userId,jdbcType=DECIMAL}
      </if>
      <if test="updateTime != null" >
       and UPDATE_TIME = #{updateTime,jdbcType=TIMESTAMP}
      </if>
      <if test="scenarinoId != null" >
       and SCENARINO_ID = #{scenarinoId,jdbcType=DECIMAL}
      </if>
      <if test="deleteTime != null" >
       and DELETE_TIME = #{deleteTime,jdbcType=TIMESTAMP}
      </if>
       <if test="basisScenarinoId != null" >
       and BASIS_SCENARINO_ID = #{basisScenarinoId,jdbcType=DECIMAL}
      </if>
       <if test="basisTime != null" >
       and BASIS_TIME = #{basisTime,jdbcType=TIMESTAMP}
      </if>
       <if test="contrastScenarinoId != null" >
       and CONTRAST_SCENARINO_ID = #{contrastScenarinoId,jdbcType=DECIMAL}
      </if>
       <if test="scenType != null " >
       and SCEN_TYPE = #{scenType,jdbcType=VARCHAR}
      </if>
       <if test="pathDate != null" >
       and PATH_DATE = #{pathDate,jdbcType=TIMESTAMP}
      </if>
      <if test="spinup != null" >
       and SPINUP = #{spinup,jdbcType=DECIMAL}
      </if>
        <if test="expand1 != null" >
       and EXPAND1 = #{expand1,jdbcType=VARCHAR}
      </if>
        <if test="expand2 != null" >
       and EXPAND2 = #{expand2,jdbcType=VARCHAR}
      </if> 
        <if test="expand3 != null" >
       and EXPAND3 = #{expand3,jdbcType=VARCHAR}
      </if>
        <if test="expand4 != null" >
       and EXPAND4 = #{expand4,jdbcType=VARCHAR}
      </if>   
        <if test="expand5 != null" >
       and EXPAND5 = #{expand5,jdbcType=VARCHAR}
      </if>
        <if test="expand6 != null" >
       and EXPAND6 = #{expand6,jdbcType=VARCHAR}
      </if>
        <if test="expand7 != null" >
       and EXPAND7 = #{expand7,jdbcType=VARCHAR}
      </if>   
        <if test="expand8 != null" >
       and EXPAND8 = #{expand8,jdbcType=VARCHAR}
      </if>      
        <if test="expand9 != null" >
       and EXPAND9 = #{expand9,jdbcType=VARCHAR}
      </if>
        <if test="expand10 != null" >
       and EXPAND10 = #{expand10,jdbcType=VARCHAR}
      </if>
  </select>
  
  
  <select id="selectByEntity2" resultMap="BaseResultMap" parameterType="ampc.com.gistone.database.model.TScenarinoDetail" >
   	 SELECT *
  		FROM T_SCENARINO_DETAIL  
			 WHERE IS_EFFECTIVE ='1'  and SCEN_TYPE !='3' and SCEN_TYPE !='4'
	  <if test="scenarinoType != null" >
       and SCENARINO_TYPE = #{scenarinoType,jdbcType=DECIMAL}
      </if>
      <if test="scenarinoName != null" >
       and SCENARINO_NAME = #{scenarinoName,jdbcType=OTHER}
      </if>
      <if test="scenarinoStartDate != null" >
       and SCENARINO_START_DATE = #{scenarinoStartDate,jdbcType=TIMESTAMP}
      </if>
      <if test="scenarinoEndDate != null" >
       and SCENARINO_END_DATE = #{scenarinoEndDate,jdbcType=TIMESTAMP}
      </if>
      <if test="scenarinoStatus != null" >
       and SCENARINO_STATUS = #{scenarinoStatus,jdbcType=DECIMAL}
      </if>
      <if test="missionId != null" >
       and MISSION_ID = #{missionId,jdbcType=DECIMAL}
      </if>
      <if test="scenarinoAddTime != null" >
       and SCENARINO_ADD_TIME = #{scenarinoAddTime,jdbcType=TIMESTAMP}
      </if>
      <if test="userId != null" >
       and USER_ID = #{userId,jdbcType=DECIMAL}
      </if>
      <if test="updateTime != null" >
       and UPDATE_TIME = #{updateTime,jdbcType=TIMESTAMP}
      </if>
      <if test="scenarinoId != null" >
       and SCENARINO_ID = #{scenarinoId,jdbcType=DECIMAL}
      </if>
      <if test="deleteTime != null" >
       and DELETE_TIME = #{deleteTime,jdbcType=TIMESTAMP}
      </if>
       <if test="basisScenarinoId != null" >
       and BASIS_SCENARINO_ID = #{basisScenarinoId,jdbcType=DECIMAL}
      </if>
       <if test="basisTime != null" >
       and BASIS_TIME = #{basisTime,jdbcType=TIMESTAMP}
      </if>
       <if test="contrastScenarinoId != null" >
       and CONTRAST_SCENARINO_ID = #{contrastScenarinoId,jdbcType=DECIMAL}
      </if>
       <if test="pathDate != null" >
       and PATH_DATE = #{pathDate,jdbcType=TIMESTAMP}
      </if>
      <if test="spinup != null" >
       and SPINUP = #{spinup,jdbcType=DECIMAL}
      </if>
        <if test="expand1 != null" >
       and EXPAND1 = #{expand1,jdbcType=VARCHAR}
      </if>
        <if test="expand2 != null" >
       and EXPAND2 = #{expand2,jdbcType=VARCHAR}
      </if> 
        <if test="expand3 != null" >
       and EXPAND3 = #{expand3,jdbcType=VARCHAR}
      </if>
        <if test="expand4 != null" >
       and EXPAND4 = #{expand4,jdbcType=VARCHAR}
      </if>   
        <if test="expand5 != null" >
       and EXPAND5 = #{expand5,jdbcType=VARCHAR}
      </if>
        <if test="expand6 != null" >
       and EXPAND6 = #{expand6,jdbcType=VARCHAR}
      </if>
        <if test="expand7 != null" >
       and EXPAND7 = #{expand7,jdbcType=VARCHAR}
      </if>   
        <if test="expand8 != null" >
       and EXPAND8 = #{expand8,jdbcType=VARCHAR}
      </if>      
        <if test="expand9 != null" >
       and EXPAND9 = #{expand9,jdbcType=VARCHAR}
      </if>
        <if test="expand10 != null" >
       and EXPAND10 = #{expand10,jdbcType=VARCHAR}
      </if>
  </select>
  <select id="selectBystandard" resultMap="BaseResultMap" parameterType="ampc.com.gistone.database.model.TScenarinoDetail">
  	 SELECT *
  		FROM T_SCENARINO_DETAIL  
			 WHERE IS_EFFECTIVE ='1'  and SCEN_TYPE ='3' 
       and MISSION_ID = #{missionId,jdbcType=DECIMAL}
       and USER_ID = #{userId,jdbcType=DECIMAL}
       and ROWNUM=1
    
  </select>
   <select id="selectByrealmax" parameterType="java.lang.Long" resultMap="BaseResultMap" >
     SELECT * FROM T_SCENARINO_DETAIL S 
		WHERE S.PATH_DATE=(SELECT MAX (PATH_DATE)
FROM
	T_SCENARINO_DETAIL
WHERE 
	SCEN_TYPE = '4'
AND IS_EFFECTIVE = '1') AND S.MISSION_ID=#{missionId,jdbcType=DECIMAL}
AND S.IS_EFFECTIVE ='1'
  </select>
   <select id="selectByrealmin" parameterType="java.lang.Long" resultMap="BaseResultMap" >
     SELECT * FROM T_SCENARINO_DETAIL S 
		WHERE S.PATH_DATE=(SELECT MIN (PATH_DATE)
FROM
	T_SCENARINO_DETAIL
WHERE 
	SCEN_TYPE = '4'
AND IS_EFFECTIVE = '1') AND S.MISSION_ID=#{missionId,jdbcType=DECIMAL}
AND S.IS_EFFECTIVE ='1'
  </select>
  
  <select id="selectBytype4" parameterType="hashMap" resultMap="BaseResultMap">
  SELECT 
		<include refid="Base_Column_List" />
  		FROM T_SCENARINO_DETAIL  
  		WHERE #{startDate,jdbcType=TIMESTAMP} &lt;= PATH_DATE AND PATH_DATE &lt;= #{endDate,jdbcType=TIMESTAMP} AND SCEN_TYPE = '4'
  </select>
  <!-- 查询预报情景数据 -->
  <select id="selectScenarinoDetail_timeSeries" parameterType="hashMap" resultMap="BaseResultMap">
	SELECT 
		<include refid="Base_Column_List" />
  		FROM 
  			T_SCENARINO_DETAIL 
  		WHERE 
  			USER_ID = #{USER_ID,jdbcType=DECIMAL}
			AND PATH_DATE ="TO_DATE"(#{PATH_DATE,jdbcType=TIMESTAMP},'yyyy-mm-dd')
			AND SCENARINO_STATUS=8
  </select>
  <!--查询情景的运行状态  -->
  <select id="selectScenExecStatus" parameterType="java.lang.Long" resultType="java.lang.Long">
  	select SCENARINO_STATUS from T_SCENARINO_DETAIL where SCENARINO_ID = #{scenarinoId,jdbcType=DECIMAL}
  </select>
  
  <!--查找最大的预报情景  -->
  <select id="getmaxRealpreiction" parameterType="java.lang.Long" resultType="java.util.Date">
  select max(PATH_DATE)
   FROM T_SCENARINO_DETAIL WHERE SCEN_TYPE='4' AND USER_ID=#{userId,jdbcType=DECIMAL}
  </select>
  <!--修改情景运行的错误状态  -->
  <update id="updateModelErrorMSG" parameterType="hashMap">
   update T_SCENARINO_DETAIL
   set
   	EXPAND4 = #{expand4,jdbcType=VARCHAR}
   where SCENARINO_ID = #{scenarinoId,jdbcType=DECIMAL}
  </update>
  <!-- 返回情景查询列表的数据 -->
  <resultMap id="scenarinoListMapNew" type="hashMap" >
    <id column="SCENARINO_ID" property="scenarinoId" jdbcType="DECIMAL" />
    <result column="SCENARINO_NAME" property="scenarinoName" jdbcType="OTHER" />
    <result column="SCENARINO_START_DATE" property="scenarinoStartDate" jdbcType="TIMESTAMP" />
    <result column="SCENARINO_END_DATE" property="scenarinoEndDate" jdbcType="TIMESTAMP" />
    <result column="SCENARINO_STATUS" property="scenarinoStatus" jdbcType="DECIMAL" />
    <result column="SCENARINO_STATU_NAME" property="scenarinoStatuName" jdbcType="OTHER" />
    <result column="SCENARINO_ADD_TIME" property="scenarinoAddTime" jdbcType="TIMESTAMP" />
    <result column="BASIS_TIME" property="basisTime" jdbcType="TIMESTAMP" />
    <result column="BASIS_SCENARINO_ID" property="basisScenarinoId" jdbcType="DECIMAL" />
    <result column="PATH_DATE" property="pathDate" jdbcType="TIMESTAMP" />
    <result column="SCEN_TYPE" property="scenType" jdbcType="VARCHAR" />
    <result column="EXPAND4" property="expand4" jdbcType="VARCHAR" />
  </resultMap>
  
  <!-- 查询当前用户下有多少个错误的情景 -->
  <select id="selectErrorCount" parameterType="java.lang.Long" resultType="java.lang.Long" >
   	 SELECT  count(*)
  		FROM T_SCENARINO_DETAIL 
			  WHERE IS_EFFECTIVE='1' AND USER_ID=#{userId,jdbcType=OTHER} 
			  AND EXPAND4!='NULL'
  </select>
  
  <!-- 查询所有的错误情景所属的任务ID -->
  <select id="selectMissionIdByErrorScenarino" parameterType="java.lang.Long" resultType="java.lang.Long" >
   	 SELECT distinct MISSION_ID
  		FROM T_SCENARINO_DETAIL 
			  WHERE IS_EFFECTIVE='1' AND USER_ID=#{userId,jdbcType=OTHER} 
			  AND EXPAND4!='NULL'
  </select>
   <!-- new根据任务Id查询情景列表 并可根据条件名模糊查询 -->
  <select id="selectByMissionIdNew" parameterType="hashMap" resultMap="scenarinoListMapNew" >
   	 SELECT  <include refid="scenarino_Column_List"/>
  		FROM T_SCENARINO_DETAIL  SCEN 
  		INNER JOIN T_SCENARINO_STATUS STAT  ON SCEN.SCENARINO_STATUS=STAT.SCENARINO_STATU_ID
			  WHERE IS_EFFECTIVE='1' AND USER_ID=#{userId,jdbcType=OTHER} 
			  AND MISSION_ID=#{missionId,jdbcType=OTHER} AND SCEN_TYPE!='4'
			  ORDER BY SCENARINO_ID DESC
  </select>
  <!-- 查询结束时间-->
<!--   <select id="selectendStart" resultMap="BaseResultMap" parameterType="ampc.com.gistone.database.model.TScenarinoDetail"> -->
<!--   	 SELECT * -->  
<!--   		FROM "AMPC"."T_SCENARINO_DETAIL"   -->
<!-- 			 WHERE  -->
<!-- 			 IS_EFFECTIVE = '1' -->
<!-- 			AND USER_ID = #{userId,jdbcType=OTHER}  -->
<!-- 			AND PATH_DATE =#{PathDate,jdbcType=TIMESTAMP} -->
    
<!--   </select> -->
  <select id="selectendStart" resultMap="BaseResultMap" parameterType="hashMap">
  select <include refid="Base_Column_List" /> 
  from T_SCENARINO_DETAIL where PATH_DATE = "TO_DATE"(#{pathDate,jdbcType=TIMESTAMP},'yyyy-MM-dd') and IS_EFFECTIVE = '1' and USER_ID = #{userId,jdbcType=DECIMAL}
  </select>
  
  <select id="selectbysid" resultMap="BaseResultMap" parameterType="hashMap">
  	SELECT
	*
	FROM
		"AMPC"."T_SCENARINO_DETAIL" T
	WHERE
		T .SCENARINO_START_DATE = "TO_DATE" (#{startDate,jdbcType=TIMESTAMP}, 'yyyy-MM-dd')
	AND T .SCEN_TYPE = 4
	AND T .USER_ID = #{userId,jdbcType=OTHER}
  </select>
  <select id="selectminpathdate" resultType="java.util.Date" >
  	SELECT
	min(PATH_DATE)
	FROM
		T_SCENARINO_DETAIL
	WHERE
	    SCEN_TYPE = 4
	
  </select>
  <select id="selectmaxpathdate" resultType="java.util.Date" >
  	SELECT
	MAX (PATH_DATE)
	FROM
		T_SCENARINO_DETAIL
	WHERE
	    SCEN_TYPE = 4  
	
  </select>
</mapper>